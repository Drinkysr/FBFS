causes <- c %>%
group_by(cause_code) %>%
filter(n() == 5) %>%
ungroup() %>%
select(cause_code) %>%
distinct()
View(causes)
table(c$yr)
#find which cause codes are in all of the years
causes <- c %>%
group_by(cause_code) %>%
filter(n() == 6) %>%
ungroup() %>%
select(cause_code) %>%
distinct()
View(causes)
table(c$cause_code, c$yr)
#find which cause codes are in all of the years
causes <- c %>%
group_by(cause_code) %>%
filter(n() == 12) %>%
ungroup() %>%
select(cause_code) %>%
distinct()
c %>%
filter(cause_code %in% causes$cause_code) %>%
ggplot(aes(x = yr, y = MR, color = cause_code)) +
geom_line(lwd = 1) +
facet_wrap(~sex) +
labs(title = "Mortality Rate Ratios vs. 2019 by Year and Cause",
x = "Year",
y = "Rate Ratio (vs. 2019)") +
theme_minimal() +
scale_color_brewer(palette = "Set1") +
# enlarge and darken the text
theme(text = element_text(size = 16, color = "black"),
legend.position = "bottom") +
labs(color = "Cause",
title = NULL, x = NULL)
c <- c %>% filter(cause_code %in% causes$cause_code)
View(c)
c <- c %>%
filter(year <= 2024,
deaths >= 50) %>%
select(yr, sex, ucd_cause, cause_code, deaths, rate, q_2019, MR, EDR)
c <- read_excel("FBFS_COD_Research.xlsx", sheet = "provisionalData")
names(c) <- c("notes","year","yr","sex","sex_c","ucd_cause", "cause_code", "deaths", "population", "crude_rate", "rate", "q_2019", "MR", "EDR")
c <- c %>%
filter(year <= 2024,
deaths >= 50) %>%
select(yr, sex, ucd_cause, cause_code, deaths, rate, q_2019, MR, EDR)
#find which cause codes are in all of the years
causes <- c %>%
group_by(cause_code) %>%
filter(n() == 12) %>%
ungroup() %>%
select(cause_code) %>%
distinct()
c <- c %>% filter(cause_code %in% causes$cause_code)
View(c)
192/12
# Plot EDR of each cause by year with sex as panel variable
p3 <- ggplot(c, aes(x = yr, y = EDR, color = cause_code)) +
geom_line(lwd = 1) +
facet_wrap(~sex) +
labs(title = "Excess Death Rate by Cause of Death",
x = "Year",
y = "Excess Death Rate") +
theme_minimal() +
scale_color_brewer(palette = "Set1") +
scale_y_log10() +
# enlarge and darken the text
theme(text = element_text(size = 16, color = "black"),
legend.position = "bottom") +
labs(color = "Cause of Death", x = NULL)
p3
c <- c %>%
filter(year <= 2024,
deaths >= 100) %>%
select(yr, sex, ucd_cause, cause_code, deaths, rate, q_2019, MR, EDR)
c <- read_excel("FBFS_COD_Research.xlsx", sheet = "provisionalData")
names(c) <- c("notes","year","yr","sex","sex_c","ucd_cause", "cause_code", "deaths", "population", "crude_rate", "rate", "q_2019", "MR", "EDR")
c <- c %>%
filter(year <= 2024,
deaths >= 100) %>%
select(yr, sex, ucd_cause, cause_code, deaths, rate, q_2019, MR, EDR)
causes <- c %>%
group_by(cause_code) %>%
filter(n() == 12) %>%
ungroup() %>%
select(cause_code) %>%
distinct()
c <- c %>% filter(cause_code %in% causes$cause_code)
# Plot EDR of each cause by year with sex as panel variable
p3 <- ggplot(c, aes(x = yr, y = EDR, color = cause)) +
geom_line(lwd = 1) +
facet_wrap(~sex) +
labs(title = "Excess Death Rate by Cause of Death",
x = "Year",
y = "Excess Death Rate") +
theme_minimal() +
scale_color_brewer(palette = "Set1") +
scale_y_log10() +
# enlarge and darken the text
theme(text = element_text(size = 16, color = "black"),
legend.position = "bottom") +
labs(color = "Cause of Death", x = NULL)
p3
# Plot EDR of each cause by year with sex as panel variable
p3 <- ggplot(c, aes(x = yr, y = EDR, color = ucd_cause)) +
geom_line(lwd = 1) +
facet_wrap(~sex) +
labs(title = "Excess Death Rate by Cause of Death",
x = "Year",
y = "Excess Death Rate") +
theme_minimal() +
scale_color_brewer(palette = "Set1") +
scale_y_log10() +
# enlarge and darken the text
theme(text = element_text(size = 16, color = "black"),
legend.position = "bottom") +
labs(color = "Cause of Death", x = NULL)
p3
View(c)
# Plot EDR of each cause by year with sex as panel variable
p3 <- ggplot(c, aes(x = yr, y = EDR, color = ucd_cause)) +
geom_line(lwd = 1) +
facet_wrap(~sex) +
labs(title = "Excess Death Rate by Cause of Death",
x = "Year",
y = "Excess Death Rate") +
theme_minimal() +
scale_color_brewer(palette = "Set1") +
#scale_y_log10() +
# enlarge and darken the text
theme(text = element_text(size = 16, color = "black"),
legend.position = "bottom") +
labs(color = "Cause of Death", x = NULL)
p3
c <- read_excel("FBFS_COD_Research.xlsx", sheet = "provisionalData")
names(c) <- c("notes","year","yr","sex","sex_c","ucd_cause", "cause_code", "deaths", "population", "crude_rate", "rate", "q_2019", "MR", "EDR")
View(c)
c <- c %>%
filter(yr <= 2024,
deaths >= 100) %>%
select(yr, sex, ucd_cause, cause_code, deaths, rate, q_2019, MR, EDR)
#find which cause codes are in all of the years
causes <- c %>%
group_by(cause_code) %>%
filter(n() == 12) %>%
ungroup() %>%
select(cause_code) %>%
distinct()
table(c$cause_code, c$yr)
#find which cause codes are in all of the years
causes <- c %>%
group_by(cause_code) %>%
filter(n() == 14) %>%
ungroup() %>%
select(cause_code) %>%
distinct()
c <- c %>% filter(cause_code %in% causes$cause_code)
# Plot EDR of each cause by year with sex as panel variable
p3 <- ggplot(c, aes(x = yr, y = EDR, color = ucd_cause)) +
geom_line(lwd = 1) +
facet_wrap(~sex) +
labs(title = "Excess Death Rate by Cause of Death",
x = "Year",
y = "Excess Death Rate") +
theme_minimal() +
scale_color_brewer(palette = "Set1") +
#scale_y_log10() +
# enlarge and darken the text
theme(text = element_text(size = 16, color = "black"),
legend.position = "bottom") +
labs(color = "Cause of Death", x = NULL)
p3
ggplotly(p3)
library(tidyverse)
alc <- read_xlsx("AlcoholLiverDisease.xlsx", sheet = "AlcoholLiverDisease")
## Alcohol and Liver disease deaths from CDC WONDER
library(readxl)
alc <- read_xlsx("AlcoholLiverDisease.xlsx", sheet = "AlcoholLiverDisease")
View(alc)
a1c <- a1c[1:147,] #remove notes
alc <- alc[1:147,] #remove notes
alc <- alc %>%
filter(Notes != "Total")
alc <- read_xlsx("AlcoholLiverDisease.xlsx", sheet = "AlcoholLiverDisease")
alc <- alc[1:147,] #remove notes
View(alc)
alc <- alc %>%
filter(is.na(Notes))
names(alc) <- tolower(make.names(names(alc)))
names(alc)
alc <- alc %>%
select(ten.year.age.groups.code, sex, year.code:crude.rate)
names(alc)
names(alc) <- c("age_group", "sex", "year", "deaths", "population", "rate")
alc <- alc %>%
filter(year <= 2024) %>%
mutate(rate = deaths/population * 100000)
View(alc)
library(plotly)
alc %>%
ggplot(aes(x = year, y = rate, color = age_group)) +
geom_line() +
facet_wrap(~sex)
alc %>%
ggplot(aes(x = year, y = rate, color = age_group)) +
geom_line(lwd = 1.5) +
facet_wrap(~sex)
alc %>%
ggplot(aes(x = year, y = rate, color = age_group)) +
geom_line(lwd = 1) +
facet_wrap(~sex)
alc %>%
filter(age_group %in% c("25-34", "35-44", "45-54", "55-64", "65-74", "75-84")) %>%
ggplot(aes(x = year, y = rate, color = age_group)) +
geom_line(lwd = 1) +
facet_wrap(~sex)
alc %>%
filter(age_group %in% c("25-34", "35-44", "45-54", "55-64", "65-74", "75-84")) %>%
ggplot(aes(x = year, y = rate, color = age_group)) +
geom_line(lwd = 1) +
facet_wrap(~sex) +
theme_minimal() +
labs(x = "Year", y = "Rate per 100,000")
alc %>%
filter(age_group %in% c("25-34", "35-44", "45-54", "55-64", "65-74", "75-84")) %>%
ggplot(aes(x = year, y = rate, color = age_group)) +
geom_line(lwd = 1) +
facet_wrap(~sex) +
theme_minimal() +
labs(x = "Year", y = "Rate per 100,000", color = "Age Group")
alc %>%
filter(age_group %in% c("25-34", "35-44", "45-54", "55-64", "65-74", "75-84")) %>%
ggplot(aes(x = year, y = rate, color = age_group)) +
geom_line(lwd = 1) +
facet_wrap(~sex) +
theme_minimal() +
scale_color_brewer(palette = "PuRd") +
scale_y_log10() +
labs(x = "Year", y = "Rate per 100,000", color = "Age Group")
alc1 <- alc %>%
filter(age_group %in% c("25-34", "35-44", "45-54", "55-64", "65-74", "75-84")) %>%
ggplot(aes(x = year, y = rate, color = age_group)) +
geom_line(lwd = 1) +
facet_wrap(~sex) +
theme_minimal() +
scale_color_brewer(palette = "PuRd") +
scale_y_log10() +
labs(x = "Year", y = "Rate per 100,000", color = "Age Group")
ggplotly(alc1) %>%
plotly::layout(legend=list(x=0, y=-0.2,
xanchor='left',
yanchor='bottom',
orientation='h'))
alc <- alc %>%
filter(year <= 2024) %>%
mutate(round(rate = deaths/population * 100000), 2)
alc <- alc %>%
filter(is.na(Notes))
alc <- read_xlsx("AlcoholLiverDisease.xlsx", sheet = "AlcoholLiverDisease")
alc <- alc[1:147,] #remove notes
alc <- alc %>%
filter(is.na(Notes))
names(alc) <- tolower(make.names(names(alc)))
alc <- alc %>%
select(ten.year.age.groups.code, sex, year.code:crude.rate)
names(alc) <- c("age_group", "sex", "year", "deaths", "population", "rate")
alc <- alc %>%
filter(year <= 2024) %>%
mutate(round(rate = deaths/population * 100000), 2)
alc <- read_xlsx("AlcoholLiverDisease.xlsx", sheet = "AlcoholLiverDisease")
alc <- alc[1:147,] #remove notes
alc <- alc %>%
filter(is.na(Notes))
names(alc) <- tolower(make.names(names(alc)))
alc <- alc %>%
select(ten.year.age.groups.code, sex, year.code:crude.rate)
names(alc) <- c("age_group", "sex", "year", "deaths", "population", "rate")
alc <- alc %>%
filter(year <= 2024) %>%
mutate(round(rate = deaths/population * 100000, 2))
alc <- read_xlsx("AlcoholLiverDisease.xlsx", sheet = "AlcoholLiverDisease")
alc <- alc[1:147,] #remove notes
alc <- alc %>%
filter(is.na(Notes))
names(alc) <- tolower(make.names(names(alc)))
alc <- alc %>%
select(ten.year.age.groups.code, sex, year.code:crude.rate)
names(alc) <- c("age_group", "sex", "year", "deaths", "population", "rate")
alc <- alc %>%
filter(year <= 2024) %>%
mutate(rate = round(deaths/population * 100000, 2))
alc1 <- alc %>%
filter(age_group %in% c("25-34", "35-44", "45-54", "55-64", "65-74", "75-84")) %>%
ggplot(aes(x = year, y = rate, color = age_group)) +
geom_line(lwd = 1) +
facet_wrap(~sex) +
theme_minimal() +
scale_color_brewer(palette = "PuRd") +
scale_y_log10() +
labs(x = "Year", y = "Rate per 100,000", color = "Age Group")
ggplotly(alc1) %>%
plotly::layout(legend=list(x=0, y=-0.2,
xanchor='left',
yanchor='bottom',
orientation='h'))
alc1 <- alc %>%
filter(age_group %in% c("25-34", "35-44", "45-54", "55-64", "65-74", "75-84")) %>%
ggplot(aes(x = year, y = rate, color = age_group)) +
geom_line(lwd = 1) +
facet_wrap(~sex) +
theme_minimal() +
scale_color_brewer(palette = "PuRd") +
#scale_y_log10() +
labs(x = "Year", y = "Rate per 100,000", color = "Age Group")
ggplotly(alc1) %>%
plotly::layout(legend=list(x=0, y=-0.2,
xanchor='left',
yanchor='bottom',
orientation='h'))
q2019 <- alc %>%
filter(year == 2019) %>%
select(sex, age_group, year, rate)
View(q2019)
q2019 <- alc %>%
filter(year == 2019) %>%
select(sex, age_group, year, rate) %>%
rename(rate_2019 = rate)
View(q2019)
alc <- left_join(alc, q2019)
alc <- alc %>%
mutate(mr_2019 = round(rate /rate_2019, 2))
alc2 <- alc %>%
filter(age_group %in% c("25-34", "35-44", "45-54", "55-64", "65-74", "75-84")) %>%
ggplot(aes(x = year, y = mr_2019, color = age_group)) +
geom_line(lwd = 1) +
facet_wrap(~sex) +
theme_minimal() +
scale_color_brewer(palette = "Blues") +
#scale_y_log10() +
labs(x = "Year", y = "Mortality Ratio", color = "Age Group")
ggplotly(alc2) %>%
plotly::layout(legend=list(x=0, y=-0.2,
xanchor='left',
yanchor='bottom',
orientation='h'))
View(alc)
alc <- left_join(alc, q2019)
alc <- read_xlsx("AlcoholLiverDisease.xlsx", sheet = "AlcoholLiverDisease")
alc <- alc[1:147,] #remove notes
alc <- alc %>%
filter(is.na(Notes))
names(alc) <- tolower(make.names(names(alc)))
alc <- alc %>%
select(ten.year.age.groups.code, sex, year.code:crude.rate)
names(alc) <- c("age_group", "sex", "year", "deaths", "population", "rate")
alc <- alc %>%
filter(year <= 2024) %>%
mutate(rate = round(deaths/population * 100000, 2))
q2019 <- alc %>%
filter(year == 2019) %>%
select(sex, age_group, year, rate) %>%
rename(rate_2019 = rate)
View(q2019)
q2019 <- alc %>%
filter(year == 2019) %>%
select(sex, age_group, rate) %>%
rename(rate_2019 = rate)
View(q2019)
alc <- left_join(alc, q2019)
View(alc)
alc <- alc %>%
mutate(mr_2019 = round(rate /rate_2019, 2))
alc2 <- alc %>%
filter(age_group %in% c("25-34", "35-44", "45-54", "55-64", "65-74", "75-84")) %>%
ggplot(aes(x = year, y = mr_2019, color = age_group)) +
geom_line(lwd = 1) +
facet_wrap(~sex) +
theme_minimal() +
scale_color_brewer(palette = "Blues") +
#scale_y_log10() +
labs(x = "Year", y = "Mortality Ratio", color = "Age Group")
ggplotly(alc2) %>%
plotly::layout(legend=list(x=0, y=-0.2,
xanchor='left',
yanchor='bottom',
orientation='h'))
alc2 <- alc %>%
filter(age_group %in% c("25-34", "35-44", "45-54", "55-64", "65-74", "75-84")) %>%
ggplot(aes(x = year, y = mr_2019, color = age_group)) +
geom_line(lwd = 1) +
facet_wrap(~sex) +
theme_dark() +
scale_color_brewer(palette = "Blues") +
#scale_y_log10() +
labs(x = "Year", y = "Mortality Ratio", color = "Age Group")
ggplotly(alc2) %>%
plotly::layout(legend=list(x=0, y=-0.2,
xanchor='left',
yanchor='bottom',
orientation='h'))
theme(text = element_text(size = 16, color = "black") +
alc2 <- alc %>%
filter(age_group %in% c("25-34", "35-44", "45-54", "55-64", "65-74", "75-84")) %>%
ggplot(aes(x = year, y = mr_2019, color = age_group)) +
geom_line(lwd = 1) +
facet_wrap(~sex) +
theme_dark() +
theme(text = element_text(size = 16, color = "black")) +
scale_color_brewer(palette = "Blues") +
#scale_y_log10() +
labs(x = "Year", y = "Mortality Ratio", color = "Age Group")
ggplotly(alc2) %>%
plotly::layout(legend=list(x=0, y=-0.2,
xanchor='left',
yanchor='bottom',
orientation='h'))
alc1 <- alc %>%
filter(age_group %in% c("25-34", "35-44", "45-54", "55-64", "65-74", "75-84")) %>%
ggplot(aes(x = year, y = rate, color = age_group)) +
geom_line(lwd = 1) +
facet_wrap(~sex) +
theme_dark() +
theme(text = element_text(size = 16, color = "black")) +
scale_color_brewer(palette = "PuRd") +
#scale_y_log10() +
labs(x = "Year", y = "Rate per 100,000", color = "Age Group")
ggplotly(alc1) %>%
plotly::layout(legend=list(x=0, y=-0.2,
xanchor='left',
yanchor='bottom',
orientation='h'))
ggplotly(alc2) %>%
plotly::layout(legend=list(x=0, y=-0.2,
xanchor='left',
yanchor='bottom',
orientation='h'))
## now for cirrhosis
cir <- read_xlsx("cirrhosis.xlsx", sheet = "cirrhosis")
## now for cirrhosis
cir <- read_xlsx("cirrhosis.xlsx", sheet = "Cirrhosis")
View(cir)
View(cir)
cir <- cir[1:138,] #remove notes
cir <- cir %>%
filter(is.na(Notes))
names(cir) <- tolower(make.names(names(cir)))
cir <- cir %>%
select(ten.year.age.groups.code, sex, year.code:crude.rate)
names(cir) <- c("age_group", "sex", "year", "deaths", "population", "rate")
cir <- cir %>%
filter(year <= 2024) %>%
mutate(rate = round(deaths/population * 100000, 2))
cir1 <- cir %>%
filter(age_group %in% c("25-34", "35-44", "45-54", "55-64", "65-74", "75-84")) %>%
ggplot(aes(x = year, y = rate, color = age_group)) +
geom_line(lwd = 1) +
facet_wrap(~sex) +
theme_dark() +
theme(text = element_text(size = 16, color = "black")) +
scale_color_brewer(palette = "PuRd") +
#scale_y_log10() +
labs(x = "Year", y = "Rate per 100,000", color = "Age Group")
ggplotly(cir1) %>%
plotly::layout(legend=list(x=0, y=-0.2,
xanchor='left',
yanchor='bottom',
orientation='h'))
q2019 <- cir %>%
filter(year == 2019) %>%
select(sex, age_group, rate) %>%
rename(rate_2019 = rate)
cir <- left_join(cir, q2019)
cir <- cir %>%
mutate(mr_2019 = round(rate /rate_2019, 2))
cir2 <- cir %>%
filter(age_group %in% c("25-34", "35-44", "45-54", "55-64", "65-74", "75-84")) %>%
ggplot(aes(x = year, y = mr_2019, color = age_group)) +
geom_line(lwd = 1) +
facet_wrap(~sex) +
theme_dark() +
theme(text = element_text(size = 16, color = "black")) +
scale_color_brewer(palette = "Blues") +
#scale_y_log10() +
labs(x = "Year", y = "Mortality Ratio", color = "Age Group")
ggplotly(cir2) %>%
plotly::layout(legend=list(x=0, y=-0.2,
xanchor='left',
yanchor='bottom',
orientation='h'))
alc <- alc %>%
filter(year <= 2024) %>%
mutate(rate = round(deaths/population * 100000, 2))
alc1 <- alc %>%
filter(age_group %in% c("25-34", "35-44", "45-54", "55-64", "65-74", "75-84")) %>%
ggplot(aes(x = year, y = rate, color = age_group)) +
geom_line(lwd = 1) +
facet_wrap(~sex) +
theme_dark() +
theme(text = element_text(size = 16, color = "black")) +
scale_color_brewer(palette = "PuRd") +
#scale_y_log10() +
labs(x = "Year", y = "Rate per 100,000", color = "Age Group")
ggplotly(alc1) %>%
plotly::layout(legend=list(x=0, y=-0.2,
xanchor='left',
yanchor='bottom',
orientation='h'))

"0","d <- read_excel(""FBFS_COD_Research.xlsx"", sheet = ""SixGroupHighIncome"")"
"0","d <- d %>% "
"0","     select(Year, Sex, `Ten-Year Age Groups Code`, Deaths:MR_2019) %>% "
"0","     filter(!is.na(Year)) %>% "
"0","     mutate(Year = case_when(Year == ""2024 (provisional)"" ~ 2024,"
"0","                             Year == ""2025 (provisional and partial)"" ~ 2025,"
"0","                             TRUE ~ as.numeric(Year)),"
"0","            MR_2019 = round(MR_2019,2)) %>% "
"0","     filter(Year <= 2024)"
"0","names(d) <- c(""year"",""sex"",""age"",""deaths"",""population"",""crude_rate"",""q_2019"", ""MR"")"
"0",""
"0","## chart of crude rates by year, with lines colored by age group and sex in panels"
"0","p1 <- ggplot(d, aes(x = year, y = crude_rate, color = age)) +"
"0","     geom_line(lwd = 1) +"
"0","     facet_wrap(~sex) +"
"0","     labs(title = NULL,"
"0","          x = ""Year"","
"0","          y = ""Crude Rate"") +"
"0","     theme_minimal() +"
"0","     scale_color_brewer(palette = ""PuRd"") +"
"0","     scale_y_log10() +"
"0","     # enlarge and darken the text"
"0","     theme(text = element_text(size = 16, color = ""black""),"
"0","           legend.position = ""bottom"") +"
"0","     labs(color = ""Age Group"", x = NULL)"
"0","ggplotly(p1) %>%"
"0","      plotly::layout(legend=list(x=0, y=-0.2,"
"0","                                 xanchor='left',"
"0","                                 yanchor='bottom',"
"0","                                 orientation='h'))"
